[集群安装手册](https://www.cnblogs.com/caoweixiong/p/14371487.html)

`rabbitmqctl` 命令行工具中的 `set_policy` 和 `set_parameter` 命令都用于配置 RabbitMQ 的参数，但它们的作用和使用方式略有不同。

1. `rabbitmqctl set_policy`:

- 用途：用于设置策略（policy），可以用于定义队列、交换机、虚拟主机等对象的行为规则。
- 参数：通常用于设置队列、交换机等对象的高可用性、过期时间、最大长度等规则。
- 示例：可以用来定义队列的镜像模式、优先级、长度限制等策略。

2. `rabbitmqctl set_parameter`:

- 用途：用于设置 RabbitMQ 服务器级别的参数，例如集群节点间的同步策略、内存限制、日志级别等。
- 参数：通常用于设置 RabbitMQ 服务器的全局配置参数。
- 示例：可以用来设置集群节点的网络同步模式、内存限制、日志级别等。

总的来说，`set_policy` 更加专注于设置对象级别的行为规则，而 `set_parameter` 则更适合设置 RabbitMQ 服务器级别的全局配置参数。

---

rabbitmqctl set_policy mirror_queue "^topic-" '{"ha-mode":"exactly","ha-params":2,"ha-sync-mode":"automatic"}' --priority 0 --apply-to queues

这个命令的作用是设置一个名为 "mirror_queue" 的策略，该策略应用于所有以 "topic-" 开头的队列。具体来说，这个命令会做以下几件事情：

1. `rabbitmqctl set_policy` 命令用于设置策略。
2. `mirror_queue` 是你为策略指定的名称。
3. `^topic-` 是一个正则表达式模式，指定了应用策略的队列名称的匹配规则。在这个例子中，策略将应用到所有以 "topic-" 开头的队列。
4. `{"ha-mode":"exactly","ha-params":2,"ha-sync-mode":"automatic"}` 是策略的配置参数。具体来说：
    - `"ha-mode":"exactly"` 指定了策略的高可用性模式为确切镜像（exactly mirrored）。这意味着队列将在指定数量的节点上进行确切的镜像。
    - `"ha-params":2` 指定了镜像节点的数量为 2。这意味着每个队列会在集群中的两个节点上进行镜像。
    - `"ha-sync-mode":"automatic"` 指定了镜像节点的同步模式为自动同步。这意味着镜像节点将自动同步消息。
5. `--priority 0` 指定了策略的优先级为 0。这意味着这个策略将按照优先级顺序应用。
6. `--apply-to queues` 指定了策略应用到队列。

--- 
