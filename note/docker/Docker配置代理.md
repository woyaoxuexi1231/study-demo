[如何优雅的给 Docker 配置网络代理-腾讯云开发者社区-腾讯云](https://cloud.tencent.com/developer/article/1806455)



尝试了多种办法，最终通过了，但是并不知道是哪种方式成功的。

配置 Linux 的代理：

```
vim /etc/profile
http_proxy=http://192.168.3.14:7890
https_proxy=http://192.168.3.14:7890
ftp_proxy=http://192.168.3.14:7890
export http_proxy
export ftp_proxy
export https_proxy
```



配置docker镜像，编辑 /etc/docker/daemon.json

```json
{
  "registry-mirrors": [
    "https://registry.cn-hangzhou.aliyuncs.com",
    "https://swr.cn-north-4.myhuaweicloud.com",
    "https://mirror.ccs.tencentyun.com"
  ],
  "dns": [
    "8.8.8.8",
    "8.8.4.4"
  ],
  "runtimes": {
    "nvidia": {
      "args": [],
      "path": "nvidia-container-runtime"
    }
  }
}
```



编辑 /etc/resolv.conf 文件

```
# Generated by NetworkManager
nameserver 192.168.3.1
nameserver 114.114.114.114
nameserver 8.8.8.8
nameserver 8.8.4.4
```



**配置 docker 的代理文件** 这个配置大概率会生效

```shell
sudo mkdir -p /etc/systemd/system/docker.service.d
sudo vim /etc/systemd/system/docker.service.d/proxy.conf

# 添加以下内容
[Service]
Environment="HTTP_PROXY=http://192.168.3.14:7890"
Environment="HTTPS_PROXY=http://192.168.3.14:7890"
Environment="NO_PROXY=localhost,127.0.0.1,.example.com"
```

